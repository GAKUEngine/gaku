/*
 *
 * Wijmo Library 2.0.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * licensing@wijmo.com
 * http://www.wijmo.com/license
 *
 **/
(function(a){"use strict";a.widget("wijmo.wijslider",a.ui.slider,{options:{buttonMouseOver:null,buttonMouseOut:null,buttonMouseDown:null,buttonMouseUp:null,buttonClick:null,dragFill:true,minRange:0},_setOption:function(d,c){var b=this;a.Widget.prototype._setOption.apply(b,arguments);this.options[d]=c;d==="disabled"&&b._handleDisabledOption(c,b.element.parent());return this},_create:function(){var c=this,b=c.element,d=c.options,s,u,i,k,n,f,e,j,g,h,m,l,p,o,t,r,q,x,y,v,w;c._oriStyle=b.attr("style");if(b.is(":input")){if(d.orientation==="horizontal")s=a("<div></div>").width(b.width()).appendTo(document.body);else s=a("<div></div>").height(b.height()).appendTo(document.body);u=b.val();if(u!=="")try{i=u.split(";");n=i.length;if(n>0){for(k=0;k<n;k++)i[k]=parseInt(i[k],10);if(n===1)d.value=i[0];else d.values=i}}catch(z){}b.data(c.widgetName,s.wijslider(d)).after(a(document.body).children("div:last")).hide();d.disabled&&c.disable();return}a.ui.slider.prototype._create.apply(c,arguments);b.data("originalStyle",b.attr("style"));b.data("originalContent",b.html());f=b.width();e=b.height();j=a("<div></div>");if(d.orientation==="horizontal")j.addClass("wijmo-wijslider-horizontal");else j.addClass("wijmo-wijslider-vertical");j.width(f).height(e);g=a('<a class="wijmo-wijslider-decbutton"><span></span></a>');h=a('<a class="wijmo-wijslider-incbutton"><span></span></a>');b.wrap(j).before(g).after(h);c._attachClass();m=g.outerWidth();l=g.outerHeight();p=h.outerWidth();o=h.outerHeight();t=b.find(".ui-slider-handle");r=t.outerWidth();q=t.outerHeight();if(d.orientation==="horizontal"){x=e/2-l/2;g.css("top",x).css("left",0);y=e/2-o/2;h.css("top",y).css("right",0);b.css("left",m+r/2-1).css("top",e/2-b.outerHeight()/2).width(f-m-p-r-2)}else{v=f/2-m/2;g.css("left",v).css("top",0);w=f/2-p/2;h.css("left",w).css("bottom",0);b.css("left",f/2-b.outerWidth()/2).css("top",l+q/2+1).height(e-l-o-q-2)}d.disabled&&c.disable();c._bindEvents()},_handleDisabledOption:function(b,c){var a=this;if(b){if(!a.disabledDiv)a.disabledDiv=a._createDisabledDiv(c);a.disabledDiv.appendTo("body")}else if(a.disabledDiv){a.disabledDiv.remove();a.disabledDiv=null}},_createDisabledDiv:function(d){var g=this,b=d?d:g.element,c=b.offset(),f=b.outerWidth(),e=b.outerHeight();return a("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:f,height:e,left:c.left,top:c.top})},destroy:function(){var b=this,c,d;c=this._getDecreBtn();d=this._getIncreBtn();c.unbind("."+b.widgetName);d.unbind("."+b.widgetName);a.ui.slider.prototype.destroy.apply(this,arguments);a("a",b.element.parent()).remove();b.element.unbind("."+b.widgetName);b.element.unwrap();if(b._oriStyle===undefined)b.element.removeAttr("style");else b.element.attr("style",b._oriStyle);b.element.removeData(b.widgetName).removeData("originalStyle").removeData("originalContent");if(b.disabledDiv){b.disabledDiv.remove();b.disabledDiv=null}},_slide:function(i,f,e){var g=this,h=g.options,c=h.minRange,d=e,b;if(h.range){b=g.values();if(f===0&&b[1]-c<e)d=b[1]-c;else if(f===1&&b[0]+c>e)d=b[0]+c}a.ui.slider.prototype._slide.call(g,i,f,d)},_getDecreBtn:function(){return this.element.parent().find(".wijmo-wijslider-decbutton")},_getIncreBtn:function(){return this.element.parent().find(".wijmo-wijslider-incbutton")},_attachClass:function(){this._getDecreBtn().addClass("ui-corner-all ui-state-default").attr("role","button");this._getIncreBtn().addClass("ui-corner-all ui-state-default").attr("role","button");this.element.parent().attr("role","slider").attr("aria-valuemin",this.options.min).attr("aria-valuenow","0").attr("aria-valuemax",this.options.max);if(this.options.orientation==="horizontal"){this.element.parent().addClass("wijmo-wijslider-horizontal");this._getDecreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-w");this._getIncreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-e")}else{this.element.parent().addClass("wijmo-wijslider-vertical");this._getDecreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-n");this._getIncreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-s")}},_bindEvents:function(){var a=this,b,c;b=this._getDecreBtn();c=this._getIncreBtn();b.bind("click."+a.widgetName,a,a._decreBtnClick);c.bind("click."+a.widgetName,a,a._increBtnClick);b.bind("mouseover."+a.widgetName,a,a._decreBtnMouseOver);b.bind("mouseout."+a.widgetName,a,a._decreBtnMouseOut);b.bind("mousedown."+a.widgetName,a,a._decreBtnMouseDown);b.bind("mouseup."+a.widgetName,a,a._decreBtnMouseUp);c.bind("mouseover."+a.widgetName,a,a._increBtnMouseOver);c.bind("mouseout."+a.widgetName,a,a._increBtnMouseOut);c.bind("mousedown."+a.widgetName,a,a._increBtnMouseDown);c.bind("mouseup."+a.widgetName,a,a._increBtnMouseUp)},_decreBtnMouseOver:function(d){var a=d.data,c,b;if(a.options.disabled)return;c={buttonType:"decreButton"};a._trigger("buttonMouseOver",d,c);b=a._getDecreBtn();b.addClass("ui-state-hover")},_increBtnMouseOver:function(d){var a=d.data,c,b;if(a.options.disabled)return;c={buttonType:"increButton"};a._trigger("buttonMouseOver",d,c);b=a._getIncreBtn();b.addClass("ui-state-hover")},_decreBtnMouseOut:function(d){var a=d.data,c,b;if(a.options.disabled)return;c={buttonType:"decreButton"};a._trigger("buttonMouseOut",d,c);b=a._getDecreBtn();b.removeClass("ui-state-hover ui-state-active")},_increBtnMouseOut:function(d){var a=d.data,c,b;if(a.options.disabled)return;c={buttonType:"increButton"};a._trigger("buttonMouseOut",d,c);b=a._getIncreBtn();b.removeClass("ui-state-hover ui-state-active")},_decreBtnMouseDown:function(e){var b=e.data,d,c;if(b.options.disabled)return;d={buttonType:"decreButton"};b._trigger("buttonMouseDown",e,d);c=b._getDecreBtn();c.addClass("ui-state-active");a(document).bind("mouseup."+b.widgetName,{self:b,ele:c},b._documentMouseUp);if(b._intervalID!==null){window.clearInterval(b._intervalID);b._intervalID=null}b._intervalID=window.setInterval(function(){b._decreBtnHandle(b)},200)},_documentMouseUp:function(c){var b=c.data.self,d=c.data.ele;if(b.options.disabled)return;d.removeClass("ui-state-active");if(b._intervalID!==null){window.clearInterval(b._intervalID);b._intervalID=null}a(document).unbind("mouseup."+b.widgetName,b._documentMouseUp)},_intervalID:null,_increBtnMouseDown:function(e){var b=e.data,d,c;if(b.options.disabled)return;d={buttonType:"increButton"};b._trigger("buttonMouseDown",e,d);c=b._getIncreBtn();c.addClass("ui-state-active");a(document).bind("mouseup."+b.widgetName,{self:b,ele:c},b._documentMouseUp);if(b._intervalID!==null){window.clearInterval(b._intervalID);b._intervalID=null}b._intervalID=window.setInterval(function(){b._increBtnHandle(b)},200)},_decreBtnMouseUp:function(d){var a=d.data,c,b;if(a.options.disabled)return;c={buttonType:"decreButton"};a._trigger("buttonMouseUp",d,c);b=a._getDecreBtn();b.removeClass("ui-state-active");window.clearInterval(a._intervalID)},_increBtnMouseUp:function(d){var a=d.data,c,b;if(a.options.disabled)return;c={buttonType:"increButton"};a._trigger("buttonMouseUp",d,c);b=a._getIncreBtn();b.removeClass("ui-state-active");window.clearInterval(a._intervalID)},_decreBtnHandle:function(a){if(a.options.orientation==="horizontal")a._decre();else a._incre()},_decreBtnClick:function(c){var a=c.data,b;if(a.options.disabled)return;a._decreBtnHandle(a);b={buttonType:"decreButton",value:a.value()};a._trigger("buttonClick",c,b)},_increBtnHandle:function(a){if(a.options.orientation==="horizontal")a._incre();else a._decre()},_increBtnClick:function(c){var a=c.data,b;if(a.options.disabled)return;a._increBtnHandle(a);b={buttonType:"increButton",value:a.value()};a._trigger("buttonClick",c,b)},_decre:function(){var a=this.value();if(!this.options.range&&!this.options.values){a=this.value();if(a<=this.options.min)this.value(this.options.min);else this.value(a-this.options.step)}else{a=this.values(0);if(a<=this.options.min)this.values(0,this.options.min);else this.values(0,a-this.options.step)}this.element.parent().attr("aria-valuenow",this.value())},_incre:function(){var a=this.value();if(!this.options.range&&!this.options.values){a=this.value();if(a>=this.options.max)this.value(this.options.max);else this.value(a+this.options.step)}else{a=this.values(1);if(a>=this.options.max)this.values(1,this.options.max);else this.values(1,a+this.options.step)}this.element.parent().attr("aria-valuenow",this.value())},_mouseInit:function(){var b=this;if(this.options.dragFill){this._preventClickEvent=false;this.element.bind("click."+b.widgetName,function(){if(b._dragFillStart>0)b._dragFillStart=0;else a.ui.slider.prototype._mouseCapture.apply(b,arguments)})}a.ui.mouse.prototype._mouseInit.apply(this,arguments)},_mouseCapture:function(b){this.element.parent().attr("aria-valuenow",this.value());if(this.options.dragFill)if(b.target.className==="ui-slider-range ui-widget-header"){this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();return true}else return a.ui.slider.prototype._mouseCapture.apply(this,arguments);else return a.ui.slider.prototype._mouseCapture.apply(this,arguments)},_dragFillTarget:false,_dragFillStart:0,_rangeValue:0,_oldValue1:0,_oldValue2:0,_oldX:0,_oldY:0,_mouseStart:function(a){if(this.options.dragFill){if(a.target)if(a.target.className==="ui-slider-range ui-widget-header"){this._dragFillTarget=true;this._rangeValue=this.values(1)-this.values(0);this._oldValue1=this.values(0);this._oldValue2=this.values(1);this._oldX=a.pageX;this._oldY=a.pageY;return true}this._dragFillTarget=false}return true},_mouseDrag:function(f){var d,c,e,b,g,h;if(this.options.dragFill){d=f.pageX-this._oldX;c=this.element.outerWidth();if(this.options.orientation==="vertical"){c=this.element.outerHeight();d=-(f.pageY-this._oldY)}e=(this.options.max-this.options.min)/c*d;if(this._dragFillTarget){if(this.options.orientation==="vertical")a(document.documentElement).css("cursor","s-resize");else a(document.documentElement).css("cursor","w-resize");if(this._dragFillStart>0){b=this._rangeValue;this.values(0,this._oldValue1+e);this.values(1,this._oldValue1+e+b);g=this.values(0);h=this.values(1);g+b>this.options.max&&this.values(0,this.options.max-b);h-b<this.options.min&&this.values(1,this.options.min+b)}this._dragFillStart++;return false}else return a.ui.slider.prototype._mouseDrag.apply(this,arguments)}else return a.ui.slider.prototype._mouseDrag.apply(this,arguments)},_mouseStop:function(){var b=a.ui.slider.prototype._mouseStop.apply(this,arguments);if(this.options.dragFill){a(document.documentElement).css("cursor","default");window.setTimeout(function(){this._dragFillTarget=false;this._dragFillStart=0},500)}return b}})})(jQuery);