<%= form_for(@student) do |f| %>
  <% if @student.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@student.errors.count, "error") %> prohibited this student from being saved:</h2>

      <ul>
      <% @student.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label t :name %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label t :address %><br />
    <%= f.text_area :address %>
  </div>
  <div class="field">
    <%= f.label t :phone %><br />
    <%= f.text_field :phone %>
  </div>
  <div class="field">
    <%= f.label t :email %><br />
    <%= f.text_field :email %>
  </div>
  <div class="field">
    <%= f.label t :birth %><br />
    <div class="hide">
      <%= f.date_select :birth %>
    </div>
    <input class="datepicker" id="dp-birth"></input>
  </div>
  <div class="field">
    <%= f.label t :admitted %><br />
    <div class="hide">
      <%= f.date_select :admitted %>
    </div>
    <input class="datepicker" id="dp-admitted"></input>
  </div>
  <div class="field">
    <%= f.label t :graduated %><br />
    <div class="hide">
      <%= f.date_select :graduated %>
    </div>
    <input class="datepicker" id="dp-graduated"></input>
  </div>
  
  <div class="main demo">
    <!-- Begin demo markup -->
    <div id="calendar">
    </div>
    <label for="popdate">Choose a Date:</label>
    <input name="popdate" type="text" id="popdate" style="width: 180px;" />
    <!-- End demo markup -->
    <div class="demo-options">
      <!-- Begin options markup -->
      <!-- End options markup -->
    </div>
  </div>
  
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>

<script type="text/javascript">
  $(function () {
    $("#calendar").wijcalendar(
  {
    popupMode: true,
    selectedDatesChanged: function (e,args) {       
      console.log(e, args);
      var selDate = $(this).wijcalendar("getSelectedDate");
      if (!!selDate) $("#popdate").val(selDate.toDateString());
    }
  });
  
  $("#popdate").click(function () {
      $("#calendar").wijcalendar("popup", {
        of: $("#popdate"),
        offset: '0 2'
      });
    })
  });
</script>


<script>
$(document).ready(function() {
  
  function ChangeBirth(e)
  {
    var date = $("#dp-birth").data("kendoDatePicker").value();
    $('#student_birth_1i').append($('<option value="'+date.getFullYear()+'">'+date.getFullYear()+'</option>'));
    $("#student_birth_1i").val(date.getFullYear());
    $("#student_birth_2i").val(date.getMonth()+1);
    $("#student_birth_3i").val(date.getDate());
  }
  
  function ChangeAdmitted(e)
  {
    var date = $("#dp-admitted").data("kendoDatePicker").value();
    $('#student_admitted_1i').append($('<option value="'+date.getFullYear()+'">'+date.getFullYear()+'</option>'));
    $("#student_admitted_1i").val(date.getFullYear());
    $("#student_admitted_2i").val(date.getMonth()+1);
    $("#student_admitted_3i").val(date.getDate());
  }
  
  function ChangeGraduated(e, args)
  {
    console.log(e, args);
    var date = $("#dp-graduated").data("kendoDatePicker").value();
    $('#student_graduated_1i').append($('<option value="'+date.getFullYear()+'">'+date.getFullYear()+'</option>'));
    $("#student_graduated_1i").val(date.getFullYear());
    $("#student_graduated_2i").val(date.getMonth()+1);
    $("#student_graduated_3i").val(date.getDate());
  }
  
  $(".datepicker").kendoDatePicker();
  $("#dp-birth").data("kendoDatePicker").bind("change", ChangeBirth);
  $("#dp-admitted").data("kendoDatePicker").bind("change", ChangeAdmitted);
  $("#dp-graduated").data("kendoDatePicker").bind("change", ChangeGraduated);

});
</script>
